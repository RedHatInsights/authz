syntax = "proto3";

// Additional imports go here

package api.v1alpha;

option go_package = "github.com/RedHatInsights/authz/proto/gen/go/core/v1alpha;core";

// Service & message definitions go here

message CheckPermissionRequest {
  string subject = 1;
  string operation = 2;
  string resourcetype = 3;
  string resourceid = 4;
}

message CheckPermissionResponse {
    bool result = 1;
    string description = 2;
}

service CheckPermission {
    rpc CheckPermission (CheckPermissionRequest) returns (CheckPermissionResponse) {}
}

// CreateSeatsRequest assuming we get the userId etc from the requestor in the authorization header to validate if an "admin" can actually add licenses.
message CreateSeatsRequest {
  string tenantId = 1; //tenantId of subjects
  repeated string subjects = 2; //list of subjects to add
  string serviceId = 3; //id of service to add subjects to as "licensed users"
}

message CreateSeatsResponse {
}

service SeatsService {
  rpc CreateSeats (CreateSeatsRequest) returns (CreateSeatsResponse) {}
}